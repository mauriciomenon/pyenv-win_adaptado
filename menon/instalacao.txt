Instalação do pyenv-win (fork adaptado) — Windows

Este guia descreve como instalar e usar este fork do pyenv-win de forma repetível, espelhando o processo do projeto original. Inclui métodos via PowerShell, Git e Zip, além dos comandos básicos de atualização, listagem e instalação de versões do Python.

Pré‑requisitos
- Windows 10/11 com PowerShell.
- Acesso à Internet para baixar o repositório e instaladores do Python.

Estrutura de diretórios
- Padrão: %USERPROFILE%\.pyenv\pyenv-win
- Subpastas: bin, shims (no PATH), libexec

Método 0 — One-liner PowerShell (recomendado)
Baixa e executa o instalador deste fork. Ele adiciona bin e shims no PATH automaticamente e atualiza o cache ao final.
Invoke-WebRequest -UseBasicParsing -Uri "https://raw.githubusercontent.com/mauriciomenon/pyenv-win_adaptado/master/pyenv-win/install-pyenv-win.ps1" -OutFile "./install-pyenv-win.ps1"; &"./install-pyenv-win.ps1"

Método 1 — PowerShell (Zip do GitHub Release deste fork)
1) Abrir PowerShell (usuário).
2) Criar pasta base:
   New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.pyenv" | Out-Null
3) Baixar ZIP da tag (ex.: v3.1.2):
   $ver = 'v3.1.2'
   $zipUrl = "https://github.com/mauriciomenon/pyenv-win_adaptado/archive/refs/tags/$ver.zip"
   $zipOut = "$env:USERPROFILE\.pyenv\pyenv-win.zip"
   (New-Object System.Net.WebClient).DownloadFile($zipUrl, $zipOut)
4) Extrair e posicionar:
   $dest = "$env:USERPROFILE\.pyenv"
   Microsoft.PowerShell.Archive\Expand-Archive -Path $zipOut -DestinationPath $dest -Force
   Move-Item -Force -Path "$dest\pyenv-win_adaptado-$ver\*" -Destination "$dest"
   Remove-Item -Recurse -Force "$dest\pyenv-win_adaptado-$ver"
   Remove-Item -Force $zipOut
5) Garantir conteúdo em %USERPROFILE%\.pyenv\pyenv-win
6) Ajustar PATH (sem duplicar):
   $bin   = "$env:USERPROFILE\.pyenv\pyenv-win\bin"
   $shims = "$env:USERPROFILE\.pyenv\pyenv-win\shims"
   $path  = [System.Environment]::GetEnvironmentVariable('PATH','User') -split ';'
   $path  = @($bin,$shims) + ($path | Where-Object { $_ -and $_ -ne $bin -and $_ -ne $shims })
   [System.Environment]::SetEnvironmentVariable('PATH',($path -join ';'),'User')
7) Atualizar cache e validar:
   cscript //nologo "%USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-update.vbs" --ignore
   cscript //nologo "%USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-install.vbs" --list | Select-Object -First 20

Método 2 — Git (repetível e versionado)
1) Clonar:
   git clone https://github.com/mauriciomenon/pyenv-win_adaptado.git "%USERPROFILE%\.pyenv\pyenv-win"
2) Ajustar PATH (se necessário): (mesmo do método 1)
3) Atualizar cache e validar:
   cscript //nologo "%USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-update.vbs" --ignore
   cscript //nologo "%USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-install.vbs" --list | Select-Object -First 20

Método 3 — Zip manual (sem Git)
- Igual ao Método 1, baixando o ZIP do release deste fork e posicionando em %USERPROFILE%\.pyenv\pyenv-win; ajustar PATH e rodar o update.

Comandos de uso (iguais ao original)
- Atualizar base:
  cscript //nologo %USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-update.vbs --ignore
- Listar versões:
  cscript //nologo %USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-install.vbs --list
- Instalar (amd64):
  cscript //nologo %USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-install.vbs 3.13.9
- Instalar (ARM64):
  cscript //nologo %USERPROFILE%\.pyenv\pyenv-win\libexec\pyenv-install.vbs 3.13.9-arm64

Observações
- Este fork atualiza o cache automaticamente no fim do script de instalação interno; nos métodos manuais, execute o update após instalar.
- Em hosts x64, amd64 é implícito; para ARM64, use sufixo -arm64.
